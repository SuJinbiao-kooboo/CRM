# CRM系统数据库配置说明

## 问题解决

您遇到的启动错误是因为数据库配置问题。我已经为您创建了本地数据库配置，请按以下步骤操作：

## 1. 数据库环境准备

### 安装MySQL
- 确保已安装MySQL 5.7或8.0版本
- 确保MySQL服务正在运行

### 检查MySQL服务状态
```bash
# Windows系统检查MySQL服务
sc query mysql

# 如果服务未启动，使用以下命令启动
net start mysql
```

## 2. 创建数据库

### 方法一：使用提供的脚本
1. 打开MySQL命令行或MySQL Workbench
2. 执行 `database/setup_local_database.sql` 脚本
3. 继续执行 `database/crm_database.sql` 创建表结构
4. 最后执行 `database/init_data.sql` 插入初始数据

### 方法二：手动创建
```sql
-- 创建数据库
CREATE DATABASE crm_system DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- 使用数据库
USE crm_system;

-- 然后执行 crm_database.sql 和 init_data.sql
```

## 3. 配置文件说明

我已经创建了两个配置文件：

### application-local.yml (本地环境)
- 数据库地址：localhost:3306
- 数据库名：crm_system
- 用户名：root
- 密码：123456

### application.yml (主配置)
- 已修改默认profile为 `local`
- 如果您的MySQL密码不是123456，请修改 `application-local.yml` 中的密码

## 4. 启动后端服务

### 使用启动脚本
```bash
# 进入后端目录
cd Back-Server

# 运行启动脚本
start-local.bat
```

### 手动启动
```bash
# 进入后端目录
cd Back-Server

# 使用Maven启动
./mvnw.cmd spring-boot:run -Dspring-boot.run.profiles=local
```

## 5. 验证启动成功

启动成功后，您应该看到类似以下日志：
```
Started CrmSystemApplication in X.XXX seconds
```

访问以下地址验证：
- 后端API：http://localhost:8080
- Druid监控：http://localhost:8080/druid (用户名：admin，密码：123456)

## 6. 常见问题解决

### 问题1：连接数据库失败
- 检查MySQL服务是否启动
- 检查数据库名、用户名、密码是否正确
- 检查防火墙设置

### 问题2：表不存在
- 确保已执行 `crm_database.sql` 创建表结构
- 检查数据库名是否正确

### 问题3：端口占用
- 检查8080端口是否被占用
- 可以在 `application-local.yml` 中修改端口号

## 7. 配置文件位置

- 主配置：`Back-Server/src/main/resources/application.yml`
- 本地配置：`Back-Server/src/main/resources/application-local.yml`
- 数据库脚本：`database/` 目录下

## 8. 下一步

数据库配置完成后，您可以：
1. 启动前端服务（在Front-Server目录执行 `npm run dev`）
2. 访问系统进行功能测试
3. 根据需要调整配置参数

如果仍有问题，请检查控制台日志获取详细错误信息。